import{$ as Se,$a as R,A as se,Aa as I,Ab as te,B as wt,Ba as ct,Bb as Kt,C as r,Ca as F,Cb as ie,D as a,Da as Ut,Db as he,E as c,Ea as Rt,Eb as oe,F as g,Fa as Vt,Fb as re,G as h,Ga as At,Gb as Qt,H as me,Ha as Nt,Hb as ne,I as C,Ia as jt,Ib as ae,J as u,Ja as Bt,Jb as qt,K as Tt,Ka as Gt,Kb as Ht,L as It,La as $t,M as Ft,Ma as O,Mb as Mt,N as y,Na as E,O as p,Ob as vt,P as S,Pb as Wt,Q as Ot,Qb as Ct,R as Et,Rb as Te,S as kt,Sb as Jt,T as Ce,Tb as Yt,U as _,V as pe,Va as ut,Wa as k,Xa as D,Y as ge,Ya as P,_ as xe,_a as U,aa as st,ba as mt,bb as V,c as fe,ca as pt,cb as A,d as we,db as N,e as bt,ea as w,eb as j,f as St,fb as B,gb as G,hb as $,ib as L,jb as z,k as ve,ka as Dt,kb as K,lb as Q,m as d,mb as Lt,n as b,nb as q,o as M,ob as H,p as v,pa as Pt,pb as W,qb as J,r as l,sb as Y,ua as de,ub as X,va as _t,wa as ue,wb as Z,x as f,xa as ye,xb as zt,y as s,ya as T,yb as ee,z as yt,za as dt,zb as ft}from"./chunk-WJY4ZHSE.js";var gt=(()=>{class t{constructor(){this.uid=localStorage.getItem("uid"),this.auth=d(Pt),this.rtd=d(Ht)}sendMessage(e,i,o){return fe(this,null,function*(){let n={from:e,to:i,message:o,on:this.getFormattedDateTime(),timestamp:Date.now()},le=Te(this.rtd,`chats/${this.getSortedSenderReceiver(e,i)}`),x=Wt(le),ht=Te(this.rtd,`lastChats/${this.getSortedSenderReceiver(e,i)}`);return Yt(ht,n),Jt(x,n)})}getMessages(e,i){let o=Te(this.rtd,`chats/${this.getSortedSenderReceiver(e,i)}`),n=Ct(o,vt("timestamp"));return Mt(n)}getRecentChats(){let e=Te(this.rtd,"lastChats"),i=Ct(e,vt("timestamp"));return Mt(i)}getSortedSenderReceiver(e,i){return[e,i].sort().join("_")}getFormattedDateTime(){let e=new Date,i=String(e.getDate()).padStart(2,"0"),o=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getFullYear()).slice(-2),le=String(e.getHours()).padStart(2,"0"),x=String(e.getMinutes()).padStart(2,"0");return`${i}/${o}/${n} ${le}:${x}`}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function be(t){let m=t.split(" ");return m.length>=2?m[0].charAt(0).toUpperCase()+m[1].charAt(0).toUpperCase():m[0].charAt(0).toUpperCase()}var _e=(()=>{class t{constructor(){this.tabSubject=new we,this.receiverSubject=new we,this.groupSubject=new we,this.callsSubject=new we,this.tab$=this.tabSubject.asObservable(),this.receiver$=this.receiverSubject.asObservable(),this.group$=this.groupSubject.asObservable(),this.calls$=this.callsSubject.asObservable()}setTab(e="Chats"){this.tabSubject.next(e)}setReceiver(e=null){this.receiverSubject.next(e)}setGroup(e=null){this.groupSubject.next(e)}setCalls(e=null){this.callsSubject.next(e)}clearAll(){this.receiverSubject.next(null),this.groupSubject.next(null),this.callsSubject.next(null)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Me=(()=>{class t{constructor(){this.mobileSidebar=new bt(!0),this.sidebar=new bt(!1),this.mobileSidebar$=this.mobileSidebar.asObservable(),this.sidebar$=this.sidebar.asObservable()}toggleMobileSidebar(){this.mobileSidebar.next(!this.mobileSidebar.value)}toggleSidebar(){this.sidebar.next(!this.sidebar.value)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var ai=()=>({"background-color":"#ece9fc",color:"#2a1261"});function li(t,m){if(t&1){let e=me();r(0,"div")(1,"div",3),C("click",function(){let o,n=M(e).$implicit,le=u(2);return v(le.startChat((o=n==null||n.other_party==null?null:n.other_party.userId)!==null&&o!==void 0?o:null))}),c(2,"p-avatar",4),r(3,"div",5)(4,"h5",6),p(5),a(),r(6,"span",7),p(7),a()()(),c(8,"div",8),a()}if(t&2){let e,i,o=m.$implicit,n=u(2);l(2),se(pe(5,ai)),s("label",n.dp((e=o==null||o.other_party==null?null:o.other_party.name)!==null&&e!==void 0?e:"Un Known")),l(3),S((i=o==null||o.other_party==null?null:o.other_party.name)!==null&&i!==void 0?i:"Anonymous"),l(2),S(o.message)}}function si(t,m){if(t&1&&(g(0),f(1,li,9,6,"div",2),h()),t&2){let e=u();l(),s("ngForOf",e.recentChats)}}function mi(t,m){if(t&1){let e=me();r(0,"div",9)(1,"span"),p(2,"No Recent Chats. "),r(3,"span",10),C("click",function(){M(e);let o=u();return v(o.navigateToFriendTab())}),p(4,"Click to start"),a()()()}}var Xt=(()=>{class t{constructor(){this.recentChats=[],this.chatService=d(gt),this.authService=d(de),this.tabService=d(_e),this.sidebarService=d(Me),this.uid=localStorage.getItem("uid")}ngOnInit(){this.getChatsRecent()}getChatsRecent(){return fe(this,null,function*(){try{this.chatService.getRecentChats().subscribe(e=>fe(this,null,function*(){let i=e.filter(n=>n.from===this.uid||n.to===this.uid),o=yield Promise.all(i.map(n=>fe(this,null,function*(){let le=n.from===this.uid?n.to:n.from,x=n.from!==this.uid?n.to:n.from;return n.other_party=yield this.loadUser(le),n.me=yield this.loadUser(x),n})));this.recentChats=o.reverse()}))}catch(e){console.error(e)}})}dp(e){return be(e)}loadUser(e){return St(this.authService.getUserById(e))}startChat(e){this.sidebarService.toggleMobileSidebar(),this.tabService.setReceiver(e)}navigateToFriendTab(){this.tabService.setTab("Friends")}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=b({type:t,selectors:[["app-my-chats"]],standalone:!0,features:[_],decls:3,vars:2,consts:[["noRecentChats",""],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],["appRipple","",1,"px-2","py-3","flex","align-items-center","gap-2","select-none","cursor-pointer","border-round",3,"click"],["size","normal",3,"label"],[1,"flex-grow-1"],[1,"m-0"],[1,"text-xs"],[1,"mx-1","surface-200",2,"height","1px"],[1,"m-3"],[1,"cursor-pointer","text-primary",3,"click"]],template:function(i,o){if(i&1&&f(0,si,2,1,"ng-container",1)(1,mi,5,0,"ng-template",null,0,ge),i&2){let n=y(2);s("ngIf",o.recentChats.length>0)("ngIfElse",n)}},dependencies:[I,F,D,R,U,V,A,N,j,P,B,G,$,L,z,K,Q,k,q,H,W,J,O,Y,X,Z,ee,te,ie,oe,he,re,ne,ae,T,E,w,xe,Se,qt],styles:["[_nghost-%COMP%]     .card-container .card{width:75px;height:75px;display:flex;align-items:center;justify-content:center;margin-right:1rem;-webkit-user-select:none;user-select:none;padding:0}[_nghost-%COMP%]     .card-container .card.primary-box{background-color:var(--primary-color);padding:0;color:var(--primary-color-text)}[_nghost-%COMP%]     .card-container .card.styled-box-green .p-ink{background:#4baf504d}[_nghost-%COMP%]     .card-container .card.styled-box-orange .p-ink{background:#ffc1064d}[_nghost-%COMP%]     .card-container .card.styled-box-purple .p-ink{background:#9c27b04d}[_nghost-%COMP%]     .card-container .card:last-child{margin-right:0}"]})}}return t})();var pi=()=>({"background-color":"#ece9fc",color:"#2a1261"});function di(t,m){if(t&1){let e=me();r(0,"div",1),c(1,"p-avatar",2),r(2,"div",3)(3,"h5",4),p(4),a(),r(5,"span",5),p(6),a()(),r(7,"p-button",6),C("onClick",function(){M(e);let o=u();return v(o.startChat(o.id))}),a()()}if(t&2){let e,i=u();l(),se(pe(7,pi)),s("label",i.dp((e=i.name)!==null&&e!==void 0?e:"Un Known")),l(3),S(i.name),l(2),S(i.email),l(),s("rounded",!0)("text",!0)}}var ei=(()=>{class t{constructor(){this.id=null,this.name=null,this.email=null,this.profile_pic=null,this.tabService=d(_e),this.sidebarService=d(Me)}dp(e){return be(e)}startChat(e){this.sidebarService.toggleMobileSidebar(),this.tabService.setReceiver(e)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=b({type:t,selectors:[["app-friend-item-view"]],inputs:{id:"id",name:"name",email:"email",profile_pic:"profile_pic"},standalone:!0,features:[_],decls:2,vars:0,consts:[["pTemplate","p-card-content"],[1,"flex","align-items-center","gap-2"],["size","normal",3,"label"],[1,"flex-grow-1"],[1,"m-0"],[1,"text-xs"],["icon","pi pi-comment","styleClass","cursor-pointer h-2rem w-2rem","severity","info",3,"onClick","rounded","text"]],template:function(i,o){i&1&&(r(0,"p-card"),f(1,di,8,8,"ng-template",0),a())},dependencies:[I,dt,ye,F,ct,D,R,U,V,A,N,j,P,B,G,$,L,z,K,Q,k,q,H,W,J,O,Y,X,Z,ee,te,ie,oe,he,re,ne,ae,T,E,w]})}}return t})();function ci(t,m){if(t&1&&(r(0,"div"),c(1,"app-friend-item-view",5),a()),t&2){let e=m.$implicit;l(),s("id",e.userId)("name",e.name)("email",e.email)("profile_pic",e.profile_pic)}}function ui(t,m){if(t&1&&(g(0),f(1,ci,2,4,"div",4),h()),t&2){let e=u(2);l(),s("ngForOf",e.users)}}function fi(t,m){}function gi(t,m){if(t&1&&(g(0),f(1,ui,2,1,"ng-container",3)(2,fi,0,0,"ng-template",null,1,ge),h()),t&2){let e=y(3),i=u();l(),s("ngIf",i.users.length!=0)("ngIfElse",e)}}function hi(t,m){t&1&&(r(0,"div",7),c(1,"p-skeleton",8),r(2,"div",9),c(3,"p-skeleton",10)(4,"p-skeleton",11),a(),c(5,"p-skeleton",12),a())}function bi(t,m){t&1&&(r(0,"div")(1,"p-card"),f(2,hi,6,0,"ng-template",6),a()())}function _i(t,m){if(t&1&&f(0,bi,3,0,"div",4),t&2){let e=u();s("ngForOf",e.userSekeletons)}}var ti=(()=>{class t{constructor(){this.users=[],this.authService=d(de),this.messageService=d(ue),this.uid=null,this.isLoading=!1,this.userSekeletons=Array(5).fill(0).map((e,i)=>i)}ngOnInit(){this.uid=localStorage.getItem("uid"),this.getUsers()}getUsers(){this.isLoading=!0;try{this.authService.getAllUsers(this.uid).subscribe(e=>{this.users=e})}catch{this.messageService.add({severity:"error",summary:"Failed",detail:"Something went wrong"})}finally{this.isLoading=!1}}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=b({type:t,selectors:[["app-friends"]],standalone:!0,features:[Ce([ue]),_],decls:4,vars:2,consts:[["loading",""],["noUsersFound",""],[1,"p-1","flex","flex-column","gap-1"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[3,"id","name","email","profile_pic"],["pTemplate","p-card-content"],[1,"flex","align-items-center","gap-2"],["width","2rem","height","2rem","borderRadius","6px"],[1,"flex-grow-1"],["styleClass","m-1","width","50%","height","14px","borderRadius","2px"],["styleClass","m-1","width","90%","height","14px","borderRadius","2px"],["styleClass","m-1","width","2rem","height","2rem","borderRadius","50%"]],template:function(i,o){if(i&1&&(r(0,"div",2),f(1,gi,4,2,"ng-container",3)(2,_i,1,1,"ng-template",null,0,ge),a()),i&2){let n=y(3);l(),s("ngIf",!o.isLoading)("ngIfElse",n)}},dependencies:[I,ye,F,ct,D,R,U,V,A,N,j,P,B,G,$,L,z,K,Q,k,q,H,W,J,O,Y,X,Z,ee,te,ie,oe,re,ne,Qt,ae,T,E,w,xe,Se,ei]})}}return t})();var ii=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=b({type:t,selectors:[["app-groups"]],standalone:!0,features:[_],decls:2,vars:0,template:function(i,o){i&1&&(r(0,"p"),p(1,"groups works!"),a())}})}}return t})();var oi=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=b({type:t,selectors:[["app-calls"]],standalone:!0,features:[_],decls:2,vars:0,template:function(i,o){i&1&&(r(0,"p"),p(1,"calls works!"),a())}})}}return t})();var Mi=()=>({"background-color":"#dee9fc",color:"#1a2551"});function vi(t,m){if(t&1&&(r(0,"a",14),c(1,"span"),a()),t&2){let e=m.$implicit;s("pTooltip",e.label),l(),wt("p-menuitem-icon pi pi-comments "+e.icon)}}function Ci(t,m){t&1&&(g(0),c(1,"app-my-chats"),h())}function xi(t,m){t&1&&(g(0),c(1,"app-friends"),h())}function Si(t,m){t&1&&(g(0),c(1,"app-groups"),h())}function yi(t,m){t&1&&(g(0),c(1,"app-calls"),h())}function wi(t,m){t&1&&(g(0),p(1,"Nothing"),h())}var ri=(()=>{class t{constructor(){this.confirmationService=d(_t),this.authServices=d(de),this.router=d(Dt),this.tabService=d(_e),this.messageService=d(ue),this.isMobileSidebarOpen=!1,this.user=null}ngOnInit(){this.items=[{label:"Chats",icon:"pi pi-comments"},{label:"Friends",icon:"pi pi-users"},{label:"Groups",icon:"pi pi-list"},{label:"Calls",icon:"pi pi-circle-on"}],this.activeMenu=this.items[0],this.tabService.tab$.subscribe(e=>{let i=this.items?.find(o=>o.label==e);this.activeMenu=i}),this.getCurrentUser()}dp(e){return be(e)}getCurrentUser(){let e=localStorage.getItem("uid");try{this.authServices.getUserById(e).subscribe(i=>{this.user=i})}catch{this.messageService.add({severity:"error",summary:"Failed",detail:"Something went wrong"})}}onTabChange(){this.tabService.setTab(this.activeMenu?.label)}confirmLogout(e){this.confirmationService.confirm({target:e.target,message:"Are you sure you want to logout from NgChats?",header:"Logout Confirmation",icon:"pi pi-info-circle",acceptButtonStyleClass:"p-button-danger p-button-text",rejectButtonStyleClass:"p-button-text p-button-text",acceptIcon:"none",rejectIcon:"none",accept:()=>fe(this,null,function*(){yield this.authServices.logout(),this.router.navigate(["/login"])}),reject:()=>{}})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=b({type:t,selectors:[["app-sidebar"]],standalone:!0,features:[Ce([_t,ue]),_],decls:22,vars:11,consts:[["op",""],[1,"w-full","bg-white","text-muted","border-round","flex","flex-column",2,"height","100%","width","100%"],[1,"flex","justify-content-between","align-items-center","text-primary"],[1,"m-2"],["styleClass","mr-2 cursor-pointer","shape","circle",3,"click","label"],[1,"flex","flex-column","w-8rem","settings"],[1,"cursor-pointer","hover:bg-blue-50","hover:text-primary","border-round"],[1,"cursor-pointer","hover:bg-red-50","text-danger","border-round",3,"click"],[3,"activeItemChange","model","activeItem"],["pTemplate","item"],[1,"w-full","flex-grow-1","overflow-y-scroll"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["role","menuitem","pripple","","tooltipPosition","top","target","undefined","tabindex","0",1,"p-ripple","p-element","p-menuitem-link",3,"pTooltip"]],template:function(i,o){if(i&1){let n=me();r(0,"div",1)(1,"div",2)(2,"h1",3),p(3,"Ng Chats"),a(),r(4,"p-avatar",4),C("click",function(x){M(n);let ht=y(6);return v(ht.toggle(x))}),r(5,"p-overlayPanel",null,0)(7,"ul",5)(8,"li",6),p(9,"Profile"),a(),r(10,"li",7),C("click",function(x){return M(n),v(o.confirmLogout(x))}),p(11,"Logout"),a()()()()(),r(12,"p-tabMenu",8),kt("activeItemChange",function(x){return M(n),Et(o.activeMenu,x)||(o.activeMenu=x),v(x)}),C("activeItemChange",function(){return M(n),v(o.onTabChange())}),f(13,vi,2,3,"ng-template",9),a(),r(14,"div",10)(15,"div",11),f(16,Ci,2,0,"ng-container",12)(17,xi,2,0,"ng-container",12)(18,Si,2,0,"ng-container",12)(19,yi,2,0,"ng-container",12)(20,wi,2,0,"ng-container",13),a()()(),c(21,"p-confirmDialog")}if(i&2){let n;l(4),se(pe(10,Mi)),s("label",o.dp((n=o.user==null?null:o.user.name)!==null&&n!==void 0?n:"Un Known")),l(8),s("model",o.items),Ot("activeItem",o.activeMenu),l(3),s("ngSwitch",o.activeMenu==null?null:o.activeMenu.label),l(),s("ngSwitchCase","Chats"),l(),s("ngSwitchCase","Friends"),l(),s("ngSwitchCase","Groups"),l(),s("ngSwitchCase","Calls")}},dependencies:[I,ye,F,D,R,U,V,A,N,j,P,B,G,$,L,ut,z,K,Q,k,q,H,W,J,O,Y,X,Z,ee,zt,te,ft,ie,Kt,oe,he,re,ne,ae,T,E,w,st,mt,pt,Xt,ti,ii,oi],styles:["ul.settings[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}ul.settings[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:.4rem .5rem}.bg-red-100[_ngcontent-%COMP%]{background-color:var(--red-100)}"]})}}return t})();var Ti=["chatBody"],xt=()=>({"background-color":"#ece9fc",color:"#2a1261"});function Ii(t,m){t&1&&(g(0),r(1,"div",9),p(2," Calls Tab "),a(),h())}function Fi(t,m){if(t&1&&(g(0),f(1,Ii,3,0,"ng-container",8),h()),t&2){let e=u(),i=y(5);l(),s("ngIf",e.calls!=null)("ngIfElse",i)}}function Oi(t,m){if(t&1&&(g(0),r(1,"div",29),c(2,"p-avatar",30),r(3,"div",31)(4,"div",32)(5,"span",33),p(6),a()(),r(7,"small"),p(8),a()()(),h()),t&2){let e,i,o=u().$implicit,n=u(3);l(2),se(pe(6,xt)),s("pTooltip",(e=n.currentUser==null?null:n.currentUser.name)!==null&&e!==void 0?e:"Un Known")("label",n.dp((i=n.currentUser==null?null:n.currentUser.name)!==null&&i!==void 0?i:"Un Known")),l(4),S(o.message),l(2),S(o.on)}}function Ei(t,m){if(t&1&&(r(0,"div",34),c(1,"p-avatar",35),r(2,"div",16)(3,"div",36)(4,"span",33),p(5),a()(),r(6,"small"),p(7),a()()()),t&2){let e,i,o=u().$implicit,n=u(3);l(),se(pe(6,xt)),s("pTooltip",(e=n.ngUser==null?null:n.ngUser.name)!==null&&e!==void 0?e:"Un Known")("label",n.dp((i=n.ngUser==null?null:n.ngUser.name)!==null&&i!==void 0?i:"Un Known")),l(4),S(o.message),l(2),S(o.on)}}function ki(t,m){if(t&1&&(r(0,"div"),f(1,Oi,9,7,"ng-container",8)(2,Ei,8,7,"ng-template",null,3,ge),a()),t&2){let e=m.$implicit,i=y(3),o=u(3);l(),s("ngIf",e.from==(o.currentUser==null?null:o.currentUser.userId))("ngIfElse",i)}}function Di(t,m){t&1&&(r(0,"small",37),p(1," Message is required "),a())}function Pi(t,m){if(t&1){let e=me();g(0),r(1,"div",9)(2,"div",10)(3,"div",11)(4,"i",12),C("click",function(){M(e);let o=u(2);return v(o.onClickToggleMobileSidebar())}),a(),c(5,"p-avatar",13),a(),r(6,"div",14)(7,"h3",15),p(8),a()(),r(9,"div",16)(10,"p-button",17),C("onClick",function(o){M(e);let n=y(12);return v(n.toggle(o))}),r(11,"p-overlayPanel",null,1)(13,"ul",18)(14,"li",19),p(15,"Favorite"),a(),r(16,"li",20),p(17,"Report"),a()()()()()(),r(18,"div",21,2),f(20,ki,4,2,"div",22),a(),r(21,"div",23)(22,"div",24)(23,"form",25),C("submit",function(){M(e);let o=u(2);return v(o.sendMessage())}),r(24,"textarea",26),p(25,"                                "),a(),c(26,"p-button",27),a(),f(27,Di,2,0,"small",28),a()()(),h()}if(t&2){let e,i,o=u(2);l(5),se(pe(10,xt)),s("label",o.dp((e=o.ngUser==null?null:o.ngUser.name)!==null&&e!==void 0?e:"Un Known")),l(3),S(o.ngUser==null?null:o.ngUser.name),l(2),s("rounded",!0)("text",!0),l(10),s("ngForOf",o.chatMessages),l(3),s("formGroup",o.messageForm),l(3),s("loading",o.isLoading),l(),s("ngIf",(o.messageForm==null||(i=o.messageForm.get("message"))==null?null:i.touched)&&(o.messageForm==null||(i=o.messageForm.get("message"))==null?null:i.hasError("required")))}}function Ui(t,m){if(t&1&&(g(0),f(1,Pi,28,11,"ng-container",8),h()),t&2){let e=u(),i=y(5);l(),s("ngIf",e.receiver!=null)("ngIfElse",i)}}function Ri(t,m){if(t&1){let e=me();r(0,"div",38)(1,"h1",39),p(2,"Hi "),r(3,"span",40),p(4),a()(),c(5,"img",41),r(6,"button",42),p(7,"Start Chatting \u{1F44B}"),a(),r(8,"button",43),C("click",function(){M(e);let o=u();return v(o.onClickToggleMobileSidebar())}),p(9,"Start Chatting \u{1F44B}"),a()()}if(t&2){let e=u();l(4),S(e.currentUser==null?null:e.currentUser.name)}}var ni=(()=>{class t{constructor(){this.tab="Chats",this.receiver=null,this.group=null,this.calls=null,this.tabService=d(_e),this.ngUser=null,this.currentUser=null,this.authService=d(de),this.messageService=d(ue),this.chatService=d(gt),this.sidebarService=d(Me),this.isLoading=!1,this.uid=null,this.chatMessages=[]}ngOnInit(){this.uid=localStorage.getItem("uid")??null,this.loadUser(this.uid,!0),this.tabService.tab$.subscribe(e=>{this.tab=e??"Chats"}),this.tabService.receiver$.subscribe(e=>{this.receiver=e??null,e!=null&&(this.loadUser(e),this.getMessageObserver())}),this.messageForm=new Nt({message:new jt(null,[Rt.required])})}dp(e="Un Known"){return be(e)}loadUser(e,i=!1){this.isLoading=!0;try{this.authService.getUserById(e).subscribe(o=>{i?this.currentUser=o:this.ngUser=o})}catch{this.messageService.add({severity:"error",summary:"Failed",detail:"Unable to fetch the user"})}finally{this.isLoading=!1}}sendMessage(){if(this.messageForm?.invalid){this.messageForm?.markAllAsTouched();return}this.isLoading=!0;try{this.chatService.sendMessage(this.uid,this.receiver,this.messageForm?.get("message")?.value),this.messageForm?.reset()}catch(e){console.log(e),this.messageService.add({severity:"error",summary:"Failed",detail:"Unable to send the message"})}finally{this.isLoading=!1}}getMessageObserver(){this.chatService.getMessages(this.uid,this.receiver).subscribe(e=>{this.chatMessages=e})}onClickToggleMobileSidebar(){this.sidebarService.toggleMobileSidebar()}ngAfterViewInit(){this.scrollToBottom()}ngAfterViewChecked(){this.scrollToBottom()}scrollToBottom(){try{this.chatBody.nativeElement.scrollTop=this.chatBody.nativeElement.scrollHeight}catch{}}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=b({type:t,selectors:[["app-chatbox"]],viewQuery:function(i,o){if(i&1&&Tt(Ti,5),i&2){let n;It(n=Ft())&&(o.chatBody=n.first)}},standalone:!0,features:[Ce([ue]),_],decls:6,vars:2,consts:[["nothing",""],["op",""],["chatBody",""],["other",""],[1,"w-full","bg-white","text-muted","border-round",2,"height","90vh"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf","ngIfElse"],[1,"w-full","flex","flex-column",2,"height","90vh"],[1,"chat-header","p-2","w-full","h-4rem","flex","align-items-center","gap-2"],[1,"flex","gap-3","align-items-center"],[1,"toggle-sidebar","pi","pi-arrow-left","m-1","cursor-pointer",3,"click"],["size","normal",3,"label"],[1,"flex-grow-1"],[1,"m-0","text-color"],[1,""],["styleClass","m-2 cursor-pointer h-2rem w-2rem","icon","pi pi-ellipsis-v","size","small",3,"onClick","rounded","text"],[1,"flex","flex-column","w-8rem","settings"],[1,"cursor-pointer","hover:bg-blue-50","hover:text-primary","border-round"],[1,"cursor-pointer","hover:bg-red-50","text-danger","border-round"],[1,"chat-body","p-2","w-full","flex-grow-1","surface-100","overflow-y-scroll"],[4,"ngFor","ngForOf"],[1,"chat-footer","p-2","w-full","flex","gap-2"],[1,"w-full"],[1,"w-full","flex","gap-2",3,"submit","formGroup"],["rows","2","formControlName","message","pInputTextarea","",1,"w-full"],["type","submit","label","SEND","icon","pi pi-send","styleClass","h-full px-5",3,"loading"],["class","text-danger",4,"ngIf"],[1,"right","flex","gap-2","m-1","flex-row-reverse"],["tooltipPosition","top","size","normal",3,"pTooltip","label"],[1,"flex","flex-column","align-items-end"],[1,"chat-right","message","bg-primary","p-2","border-round","max-w-25rem"],[1,"w-full","h-full","text-overflow-wrap"],[1,"left","flex","gap-2","m-1"],["size","normal",3,"pTooltip","label"],[1,"chat-left","message","bg-primary","p-2","border-round","max-w-25rem","ml-10"],[1,"text-danger"],[1,"w-full","flex","flex-column","justify-content-center","align-items-center","gap-5",2,"height","90vh"],[2,"font-size","2.4rem"],[1,"text-primary"],["src","https://raw.githubusercontent.com/anks1245/ng-chat/refs/heads/gh-pages/assets/ChatNow.jpg","alt","chat-img","height","50%"],[1,"chat","btn-grad"],[1,"chat-mobile","btn-grad",3,"click"]],template:function(i,o){i&1&&(r(0,"div",4)(1,"div",5),f(2,Fi,2,2,"ng-container",6)(3,Ui,2,2,"ng-container",7),a(),f(4,Ri,10,1,"ng-template",null,0,ge),a()),i&2&&(l(),s("ngSwitch",o.tab),l(),s("ngSwitchCase","Calls"))},dependencies:[I,dt,F,D,R,U,V,A,N,j,P,B,G,$,L,ut,z,K,Q,k,q,Lt,H,W,J,O,Bt,Ut,Vt,At,Y,X,Z,ee,te,ft,ie,oe,he,re,ne,ae,T,E,Gt,$t,w,xe,Se,st,mt,pt],styles:['ul.settings[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}ul.settings[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:.4rem .5rem}.bg-red-100[_ngcontent-%COMP%]{background-color:var(--red-100)}.chat-body[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#b4b4b4 #f1f1f1}.chat-left[_ngcontent-%COMP%]{position:relative;background:#3b82f6;color:#fff;padding:12px 16px;border-radius:12px}.chat-left[_ngcontent-%COMP%]:before{content:"";position:absolute;top:5px;left:-5px;width:0;height:0;border-top:5px solid transparent;border-right:5px solid #3b82f6;border-bottom:5px solid transparent}.chat-right[_ngcontent-%COMP%]{position:relative;background:#3b82f6;color:#fff;padding:12px 16px;border-radius:12px}.chat-right[_ngcontent-%COMP%]:before{content:"";position:absolute;top:5px;right:-5px;width:0;height:0;border-top:5px solid transparent;border-left:5px solid #3b82f6;border-bottom:5px solid transparent}.btn-grad[_ngcontent-%COMP%]{border:none;font-size:14px;background-image:linear-gradient(to right,#00d2ff,#3a7bd5 51%,#00d2ff)}.btn-grad[_ngcontent-%COMP%]{margin:10px;padding:15px 45px;text-align:center;text-transform:uppercase;transition:.5s;background-size:200% auto;color:#fff;box-shadow:0 0 20px #eee;border-radius:10px;display:block}.btn-grad[_ngcontent-%COMP%]:hover{background-position:right center;color:#fff;text-decoration:none}.chat[_ngcontent-%COMP%]{display:block}@media (max-width: 768px){.chat[_ngcontent-%COMP%]{display:none}}.chat-mobile[_ngcontent-%COMP%]{display:none}@media (max-width: 768px){.chat-mobile[_ngcontent-%COMP%]{display:block}}.toggle-sidebar[_ngcontent-%COMP%]{display:none}@media (max-width: 768px){.toggle-sidebar[_ngcontent-%COMP%]{display:block}}']})}}return t})();var Cr=(()=>{class t{constructor(){this.authService=d(de),this.sidebarService=d(Me),this.isMobileSidebarOpen=!1}ngOnInit(){this.getAllUsers(),this.subs=this.sidebarService.mobileSidebar$.subscribe(e=>{this.isMobileSidebarOpen=e})}getAllUsers(){this.authService.getAllUsers().subscribe(e=>{localStorage.setItem("users",JSON.stringify(e))})}ngOnDestroy(){this.subs.unsubscribe()}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=b({type:t,selectors:[["app-chats"]],standalone:!0,features:[_],decls:6,vars:2,consts:[[1,"w-screen","min-h-screen","bg-primary","flex","justify-content-center","align-items-center"],[1,"flex","gap-2","align-items-center",2,"height","95vh","width","95vw"],[1,"sidebar"],[1,"chatbox","flex-grow-1"]],template:function(i,o){i&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),c(3,"app-sidebar"),a(),r(4,"div",3),c(5,"app-chatbox"),a()()()),i&2&&(l(2),yt("open",o.isMobileSidebarOpen))},dependencies:[E,w,I,F,D,R,U,V,A,N,j,P,B,G,$,L,z,K,Q,k,q,H,W,J,O,Y,X,Z,ee,te,ie,oe,re,ne,ae,T,ri,ni],styles:[".grid[_ngcontent-%COMP%]{margin:0}.sidebar[_ngcontent-%COMP%]{width:22rem;height:90vh}@media (max-width: 1024px){.sidebar[_ngcontent-%COMP%]{width:18rem}}@media (max-width: 768px){.sidebar[_ngcontent-%COMP%]{position:absolute;width:100vw;left:-100vw;height:100vh;overflow:hidden;background-color:#0000004d;z-index:999}.sidebar.open[_ngcontent-%COMP%]{left:0;box-shadow:#00000040 0 54px 55px,#0000001f 0 -12px 30px,#0000001f 0 4px 6px,#0000002b 0 12px 13px,#00000017 0 -3px 5px}}"]})}}return t})();export{Cr as ChatsComponent};
